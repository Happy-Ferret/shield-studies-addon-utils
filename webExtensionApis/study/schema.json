[
  {
    "namespace": "study",
    "description": "Interface for shield studies, for use by `background.js` scripts.",
    "apiVersion": 5,
    "types": [
      {
        "name": "studySetup"
      },
      {
        "name": "weightedVariations"
      },
      {
        "name": "anEnding"
      },
      {
        "name": "telemetrySelectionOptions"
      }
    ],
    "functions": [
      {
        "name": "configure",
        "type": "function",
        "description": "Configure the study.  Most things can't work without this",
        "async": true,
        "fakereturn": null,
        "parameters": [
          {
            "name": "studySetup",
            "type": "object"
          }
        ]
      },
      {
        "name": "install",
        "async": true,
        "description": "all for side effects (sending 'install', 'enter') pings",
        "returns": "Nothing",
        "parameters": []
      },
      {
        "name": "startup",
        "async": true,
        "description": "all for side effects (setActiveExperiment)",
        "returns": "Nothing",
        "parameters": []
      },
      {
        "name": "endStudy",
        "async": true,
        "defaultReturn": "endingName",
        "description": "Optionally opens url, then ends study with pings ending, exit.  Study can only have one ending.  Uninstalls addon?",
        "parameters": [
          {
            "name": "anEnding",
            "type": "object"
          }
        ],
        "returns": "none"
      },
      {
        "name": "info",
        "async": true,
        "defaultReturn": {
          "variation": "styleA"
        },
        "returns": "object with branch and other useful data from a configured study"
      },
      {
        "name": "permissions",
        "async": true,
        "defaultReturn": {
          "shield": true,
          "pioneer": false
        },
        "returns": "object of permissions with keys shield, pioneer, telemetry, 'ok'"
      },
      {
        "name": "sendTelemetry",
        "async": true,
        "parameters": [
          {
            "name": "payload",
            "type": "object"
          },
          {
            "name": "type"
          }
        ],
        "defaultReturn": "undefined",
        "returns": "Nothing"
      },
      {
        "name": "getTelemetry",
        "async": true,
        "defaultReturn": [
          {
            "pingType": "main"
          }
        ],
        "returns": "Array of Telemetry pings",
        "parameters": [
          {
            "name": "telemetrySelectionOptions",
            "description": "`{ type, n, minTimestamp, headersOnly }`"
          }
        ]
      },
      {
        "name": "deterministicVariation",
        "defaultReturn": "styleA",
        "returns": "Name of a variation from weightedVariations",
        "async": true,
        "parameters": [
          {
            "name": "weightedVariations",
            "type": "object"
          },
          {
            "name": "algorithm",
            "type": "string"
          },
          {
            "name": "fraction",
            "optional": true,
            "type": "Number"
          }
        ]
      },
      {
        "name": "surveyUrl",
        "async": true,
        "defaultReturn": "https://example.com?version=59.0&branch=studyA",
        "parameters": [
          {
            "name": "baseUrl",
            "type": "string"
          }
        ],
        "returns": "a url with queryArgs appended / mixed using our usual pattern"
      },
      {
        "name": "validateJSON",
        "async": true,
        "defaultReturn": {
          "valid": true,
          "errors": []
        },
        "returns": "a validation object",
        "parameters": [
          {
            "name": "anObject",
            "type": "object"
          },
          {
            "name": "schema",
            "type": "object"
          }
        ]
      }
    ],
    "events": [
      {
        "name": "onPermissionsChange",
        "type": "function",
        "defaultReturn": {
          "shield": true,
          "pioneer": false
        },
        "description": "Fires whenever any 'permission' changes, with the new permissions object",
        "parameters": [
          {
            "name": "updatedPermissions",
            "type": "object"
          }
        ]
      }
    ]
  }
]
